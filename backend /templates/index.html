<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ML Classifier</title>
    <style>
        :root{
            --bg:#0f172a;           /* slate-900 */
            --panel:#111827cc;      /* slate-900 alpha */
            --card:#111827;         /* slate-900 */
            --muted:#94a3b8;        /* slate-400 */
            --text:#e5e7eb;         /* gray-200 */
            --primary:#3b82f6;      /* blue-500 */
            --primary-600:#2563eb;  /* blue-600 */
            --accent:#22c55e;       /* green-500 */
            --danger:#ef4444;       /* red-500 */
            --warning:#f59e0b;      /* amber-500 */
            --border:#1f2937;       /* gray-800 */
        }
        * { box-sizing: border-box; }
        html, body { height: 100%; }
        body {
            margin: 0;
            font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
            color: var(--text);
            background: radial-gradient(1000px 600px at 10% 0%, #1e293b 0, #0b1220 60%, #030712 100%);
            display: grid;
            place-items: center;
            padding: 24px;
        }
        .card {
            width: 100%;
            max-width: 820px;
            background: linear-gradient(180deg, #0b1220, #0a0f1a);
            border: 1px solid var(--border);
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,.4), inset 0 1px 0 rgba(255,255,255,.03);
            overflow: hidden;
        }
        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px 24px;
            border-bottom: 1px solid var(--border);
            background: linear-gradient(180deg, rgba(59,130,246,.06), transparent 60%);
        }
        .title {
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 700;
            letter-spacing: .2px;
        }
        .title .logo {
            width: 36px; height: 36px; border-radius: 8px;
            background: radial-gradient(circle at 30% 30%, #60a5fa 0, #2563eb 40%, #1e40af 100%);
            box-shadow: inset 0 0 12px rgba(255,255,255,.12), 0 6px 18px rgba(30,64,175,.35);
        }
        .subtitle { color: var(--muted); font-size: 14px; }

        .content { padding: 20px 24px; display: grid; gap: 16px; }
        .row { display: grid; gap: 12px; }
        @media (min-width: 720px) {
            .grid-2 { grid-template-columns: 1fr 300px; gap: 20px; }
        }

        label { color: var(--muted); font-size: 13px; }
        textarea {
            width: 100%;
            min-height: 160px;
            resize: vertical;
            padding: 14px 14px 14px 44px;
            color: var(--text);
            background: #0b1020;
            border: 1px solid var(--border);
            border-radius: 12px;
            outline: none;
            line-height: 1.5;
            transition: border .15s ease, box-shadow .15s ease;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="%2360a5fa" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h7"/><path d="M14 2h6v6"/><path d="M14 10L20 4"/></svg>');
            background-repeat: no-repeat;
            background-position: 12px 14px;
        }
        textarea:focus { border-color: #1d4ed8; box-shadow: 0 0 0 3px rgba(37,99,235,.25); }

        .btns { display: flex; flex-wrap: wrap; gap: 10px; }
        .btn {
            appearance: none; border: 1px solid transparent; cursor: pointer; user-select: none;
            padding: 10px 14px; border-radius: 10px; font-weight: 600; letter-spacing: .2px;
            transition: background .15s ease, border .15s ease, transform .06s ease;
            display: inline-flex; align-items: center; gap: 8px; color: #e5e7eb;
        }
        .btn:active { transform: translateY(1px); }
        .btn-primary { background: var(--primary); }
        .btn-primary:hover { background: var(--primary-600); }
        .btn-ghost { background: transparent; border-color: var(--border); }
        .btn-ghost:hover { border-color: #334155; background: rgba(148,163,184,.06); }
        .btn-accent { background: #16a34a; }
        .btn-accent:hover { background: #15803d; }
        .btn-danger { background: var(--danger); }
        .btn-danger:hover { background: #dc2626; }
        .btn-warning { background: var(--warning); color: #111827; }
        .btn-warning:hover { background: #d97706; }
        .btn[disabled] { opacity: .6; cursor: not-allowed; }

        .aside {
            border: 1px solid var(--border); border-radius: 12px; padding: 14px; background: #0b1020;
        }
        .aside h3 { margin: 0 0 8px 0; font-size: 14px; color: var(--muted); }
        .samples { display: grid; gap: 8px; }

        .result-wrap { border: 1px solid var(--border); border-radius: 12px; padding: 14px; background: #0b1020; }
        .result-title { color: var(--muted); font-size: 13px; margin-bottom: 8px; }
        .note { 
            margin-top: 8px; 
            padding: 8px 12px; 
            background: rgba(59, 130, 246, 0.1); 
            border: 1px solid rgba(59, 130, 246, 0.2); 
            border-radius: 6px; 
            color: #93c5fd; 
            font-size: 12px; 
            line-height: 1.4;
        }
        .badge { display: inline-flex; align-items: center; gap: 8px; padding: 8px 12px; border-radius: 999px; font-weight: 700; letter-spacing: .3px; }
        .badge-true { background: rgba(34,197,94,.15); color: #22c55e; border: 1px solid rgba(34,197,94,.25); }
        .badge-fake { background: rgba(239,68,68,.15); color: #ef4444; border: 1px solid rgba(239,68,68,.25); }
        .badge-none { background: rgba(148,163,184,.1); color: var(--muted); border: 1px dashed rgba(148,163,184,.25); }
        .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; }

        .footer { padding: 16px 24px; border-top: 1px solid var(--border); color: var(--muted); font-size: 12px; display:flex; justify-content: space-between; align-items:center; }
        .status-dot { width:10px; height:10px; border-radius:50%; display:inline-block; margin-right:8px; background:#64748b; }
        .status-ok { background:#22c55e; }
        .status-err { background:#ef4444; }

        /* Light theme overrides */
        [data-theme="light"] body { color: #0f172a; background: radial-gradient(1000px 600px at 10% 0%, #e2e8f0 0, #f8fafc 70%, #ffffff 100%); }
        [data-theme="light"] .card { background: linear-gradient(180deg, #ffffff, #f8fafc); border-color: #e5e7eb; box-shadow: 0 10px 30px rgba(0,0,0,.06), inset 0 1px 0 rgba(255,255,255,.6); }
        [data-theme="light"] .header { background: linear-gradient(180deg, rgba(37,99,235,.08), transparent 60%); border-bottom-color: #e5e7eb; }
        [data-theme="light"] .subtitle, [data-theme="light"] label { color: #475569; }
        [data-theme="light"] textarea { background: #ffffff; color: #0f172a; border-color: #e5e7eb; }
        [data-theme="light"] .aside, [data-theme="light"] .result-wrap { background: #ffffff; border-color: #e5e7eb; }
        [data-theme="light"] .footer { border-top-color: #e5e7eb; color: #64748b; }
        [data-theme="light"] .btn-ghost:hover { border-color: #cbd5e1; background: rgba(2,6,23,.03); }
        [data-theme="light"] .badge-none { background: rgba(100,116,139,.12); color: #475569; border-color: rgba(100,116,139,.25); }
        [data-theme="light"] .status-dot { background: #94a3b8; }
    </style>
</head>
<body>
    <div class="card" role="region" aria-label="Classifier">
        <div class="header">
            <div class="title">
                <div class="logo" aria-hidden="true"></div>
                <div>
                    <div>Text Classification</div>
                    <div class="subtitle">Paste text, click Predict, see the label.</div>
                </div>
            </div>
            <div class="btns">
            <button class="btn btn-ghost" id="themeBtn" title="Toggle theme" onclick="toggleTheme()">☀️ Light</button>
                <button class="btn btn-ghost" id="healthBtn" title="Check health" onclick="checkHealth()">
                    <span class="status-dot" id="healthDot"></span>Health
                </button>
            </div>
        </div>

        <div class="content grid-2">
            <div class="row">
                <label for="inputText">Input text</label>
                <textarea id="inputText" placeholder="Enter text here..." aria-label="Input text"></textarea>
                <div class="btns">
                    <button class="btn btn-primary" id="predictBtn" onclick="predict()">▶ Predict</button>
                    <button class="btn btn-danger" onclick="clearForm()">✕ Clear</button>
                </div>

                <div class="result-wrap" aria-live="polite">
                    <div class="result-title">Prediction</div>
                    <div id="result" class="badge badge-none">Waiting for input…</div>
                    <div id="note" class="note" style="display: none;"></div>
                </div>
            </div>

            <aside class="aside">
                <h3>Quick samples</h3>
                <div class="samples">
                    <button class="btn btn-accent" onclick="useSample('true')">✓ Use TRUE sample</button>
                    <button class="btn btn-warning" onclick="useSample('fake')">! Use FAKE sample</button>
                    <button class="btn btn-ghost" onclick="copyResult()">⧉ Copy result</button>
                </div>
            </aside>
        </div>

        <div class="footer">
            <div><span class="mono">POST /predict</span> expects { text: string }</div>
            <div class="subtitle">Cmd/Ctrl + Enter to Predict</div>
        </div>
    </div>

    <script>
        const inputEl = document.getElementById('inputText');
        const resultEl = document.getElementById('result');
        const noteEl = document.getElementById('note');
        const predictBtn = document.getElementById('predictBtn');
        const healthDot = document.getElementById('healthDot');
            const themeBtn = document.getElementById('themeBtn');

            function getSystemPref() {
                return window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark';
            }

            function applyTheme(theme) {
                const t = theme || localStorage.getItem('theme') || getSystemPref();
                if (t === 'light') {
                    document.documentElement.setAttribute('data-theme', 'light');
                    themeBtn.textContent = '🌙 Dark';
                } else {
                    document.documentElement.removeAttribute('data-theme');
                    themeBtn.textContent = '☀️ Light';
                }
            }

            function toggleTheme(){
                const isLight = document.documentElement.getAttribute('data-theme') === 'light';
                const next = isLight ? 'dark' : 'light';
                localStorage.setItem('theme', next);
                applyTheme(next);
            }

        function setLoading(loading){
            predictBtn.disabled = !!loading;
            predictBtn.textContent = loading ? '… Predicting' : '▶ Predict';
            if (loading) hideNote();
        }

        function setResultBadge(text, kind){
            resultEl.className = 'badge ' + (kind === 'true' ? 'badge-true' : kind === 'fake' ? 'badge-fake' : 'badge-none');
            resultEl.textContent = text;
        }
        
        function showNote(text) {
            noteEl.textContent = text;
            noteEl.style.display = 'block';
        }
        
        function hideNote() {
            noteEl.style.display = 'none';
        }

        async function predict() {
            const text = inputEl.value;
            setLoading(true);
            try {
                const res = await fetch('/predict', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ text })
                });
                        const data = await res.json();
                        if (!res.ok) {
                            setResultBadge(`Error: ${data.error || res.statusText}`, 'none');
                            hideNote();
                            return;
                        }
                        const label = (data.prediction ?? '').toString().trim();
                        const norm = label.toLowerCase();
                                        if (["true", "real", "genuine"].includes(norm)) {
                                            setResultBadge('REAL', 'true');
                                        } else if (["fake", "false"].includes(norm)) {
                                            setResultBadge('FAKE', 'fake');
                        } else {
                                            setResultBadge(`Prediction: ${label || '<none>'}`, 'none');
                        }
                        
                        // Show note if provided
                        if (data.note) {
                            showNote(data.note);
                        } else {
                            hideNote();
                        }
            } catch (e) {
                setResultBadge('Network error', 'none');
            } finally {
                setLoading(false);
            }
        }

        function clearForm(){
            inputEl.value = '';
            setResultBadge('Waiting for input…', 'none');
            inputEl.focus();
        }

            // Sample pools with real test cases we used earlier
            const samplesTrue = [
                'The Federal Reserve announced today a 0.25% interest rate cut following their monthly meeting. The decision was made unanimously by the Federal Open Market Committee after reviewing current economic indicators including inflation rates and employment data.',
                'The World Health Organization released new guidelines today for international travel health requirements. The guidelines include updated vaccination recommendations and health screening procedures for travelers entering different countries.',
                'Apple Inc. reported quarterly earnings that exceeded analyst expectations, with revenue of $81.8 billion for the third quarter. The company cited strong iPhone sales and growth in services revenue as key factors in the positive results.',
                'The European Central Bank announced a 0.5% interest rate increase today following concerns about inflation. The decision affects monetary policy across the eurozone and is expected to impact lending rates.',
                'Microsoft reported strong quarterly earnings with cloud services revenue up 23% year-over-year. Azure platform growth continues to drive the companys expansion in enterprise markets.',
                'The United Nations Security Council voted unanimously to extend humanitarian aid to conflict-affected regions. The resolution provides $2.4 billion in emergency funding for displaced populations.',
                'Tesla stock surged 8% after the company announced record vehicle deliveries for the third quarter. CEO Elon Musk credited improved manufacturing efficiency at the Austin and Shanghai plants.'
            ];
            const samplesFake = [
                'BREAKING: Scientists discover that vaccines contain microchips designed to control your mind. Government officials refuse to comment on this shocking revelation that will change everything you know about medicine.',
                'Local doctors hate this one weird trick! This miracle cure will eliminate all diseases overnight using only ingredients from your kitchen. Big Pharma doesnt want you to know about this secret that has been hidden for centuries.',
                'Celebrity doctors reveal shocking truth: This simple kitchen ingredient can cure diabetes, cancer, and heart disease in just 3 days! Pharmaceutical companies are trying to ban this miracle cure that Big Pharma doesnt want you to know about.',
                'You wont believe what happened next! This mom discovered one weird trick that makes dentists furious. She never has to brush her teeth again using this simple method that costs less than $5.',
                'AMAZING DISCOVERY: This single superfood eliminates wrinkles overnight! Celebrities are going crazy for this anti-aging secret that dermatologists dont want you to know. Get younger skin in just 24 hours!',
                'BREAKING: Local man makes $50,000 per week working from home with this one simple trick! No experience needed. Click here to discover the secret that banks hate!',
                'URGENT WARNING: Your smartphone is spying on you 24/7! Former NSA agent reveals how to stop government surveillance with this simple $10 device that blocks all tracking signals.',
                'EXPOSED: Fitness trainers dont want you to know this belly fat secret! This simple morning ritual melts away stubborn fat faster than any workout. Try it tonight!'
            ];
            function randomPick(arr){
                return arr[Math.floor(Math.random() * arr.length)];
            }
            function useSample(type){
                const text = type === 'true' ? randomPick(samplesTrue) : randomPick(samplesFake);
                inputEl.value = text;
                setTimeout(() => inputEl.focus(), 0);
            }

        async function checkHealth(){
            try {
                const res = await fetch('/health');
                const data = await res.json();
                if (res.ok && data.status === 'ok') {
                    healthDot.classList.remove('status-err');
                    healthDot.classList.add('status-ok');
                } else {
                    healthDot.classList.remove('status-ok');
                    healthDot.classList.add('status-err');
                }
            } catch {
                healthDot.classList.remove('status-ok');
                healthDot.classList.add('status-err');
            }
        }

        function copyResult(){
            const text = resultEl.innerText;
            navigator.clipboard?.writeText(text);
        }

        // Keyboard shortcut: Cmd/Ctrl + Enter
        window.addEventListener('keydown', (e) => {
            if ((e.metaKey || e.ctrlKey) && e.key === 'Enter') predict();
        });

        // Initial theme + health check (non-blocking)
        applyTheme();
        checkHealth();
    </script>
</body>
</html>
